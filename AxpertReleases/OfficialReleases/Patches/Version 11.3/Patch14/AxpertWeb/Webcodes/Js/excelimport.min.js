/*https://web.agile-labs.com/minZIP/*//*version=3.9.1*/var xlresult,xlGridfieldNames,xlDcNo,xlRowCount,IsgridummyRow=!1;function ImportGridData(){if(callParentNew("gridDummyRowVal").length>0&&callParentNew("gridDummyRowVal").map(function(e){e.split("~")[0]==xlDcNo&&(IsgridummyRow=!0)}),void 0!==xlresult){var e=ExcelImpJsonToXML(xlresult);callParentNew("closeModalDialog()","function"),parent.ExcelImportGridCall(e,xlDcNo)}else showAlertDialog("error","File does not have the data")}function ExcelImpJsonToXML(e){for(var l="",t=e[0].map(function(e){var l=e.match(/\(([^)]+)\)(?!.*\()/);return l?l[1]:e.replace(/\W/g,"_")}),r=1;r<e.length;r++){l+="<row>";for(var a=e[r],o=0;o<t.length;o++){var n=t[o],i=a[o],c=parent.CheckSpecialCharsInStr(i);l+="<".concat(n,">").concat(c,"</").concat(n,">")}l+="</row>"}return l}$(function(){$("#excelimport").click(function(){if(callParentNew("gridDummyRowVal").length>0&&callParentNew("gridDummyRowVal").map(function(e){e.split("~")[0]==xlDcNo&&(IsgridummyRow=!0)}),xlRowCount>0&&!IsgridummyRow)var e=$.confirm({theme:"modern",title:appGlobalVarsObject.lcm[155],closeIcon:!0,onContentReady:function(){disableBackDrop("bind")},backgroundDismiss:"false",escapeKey:"buttonB",content:"Do You Want to Append?<br> Yes will Append, No will clear the existing data and import again!",buttons:{buttonA:{text:"Yes",btnClass:"btn btn-primary",action:function(){ImportGridData(),e.close()}},buttonB:{text:"No",btnClass:"btn btn-bg-light btn-color-danger btn-active-light-danger",action:function(){IsgridummyRow=!1,parent.$j("#chkallgridrow"+xlDcNo).prop("checked","checked"),parent.clearDataGrid(xlDcNo,"excelimport"),xlRowCount=0;var e=setInterval(function(){"false"==callParentNew("isExcelImpDelWS")&&(clearInterval(e),ImportGridData())},2e3);disableBackDrop("destroy")}}}});else if(IsgridummyRow){try{callParentNew("gridDummyRowVal").length>0&&callParentNew("gridDummyRowVal").map(function(e){e.split("~")[0]==xlDcNo&&callParentNew("gridDummyRowVal").splice($.inArray(e,callParentNew("gridDummyRowVal")),1)})}catch(t){}IsgridummyRow=!1,parent.$j("#chkallgridrow"+xlDcNo).prop("checked","checked"),parent.clearDataGrid(xlDcNo,"excelimport"),xlRowCount=0;var l=setInterval(function(){"false"==callParentNew("isExcelImpDelWS")&&(clearInterval(l),parent.$j("#chkallgridrow"+xlDcNo).prop("checked",""),ImportGridData())},2e3)}else ImportGridData()})}),$j(document).ready(function(){$("#excelfile").bind({change:function change(e){var filename=$("#excelfile").val(),fName=filename.toString().split("\\");filename=fName[fName.length-1],$("#noFile").text(filename);var file=e.target.files[0],files=e.target.files,f=files[0],FR=new FileReader;FR.onload=function(e){var data=new Uint8Array(e.target.result),workbook=XLSX.read(data,{type:"array",cellDates:!0,dateNF:"dd/mm/yyyy;@"}),firstSheet=workbook.Sheets[workbook.SheetNames[0]],result=XLSX.utils.sheet_to_json(firstSheet,{header:1,raw:!1});if(0!=result.length&&(result=result.filter(function(e){return e.some(function(e){return""!==e&&null!==e})})),0!=result.length){var dcNo=window.location.href.split("=")[1],gridFieldNames=callParentNew("GetGridFields("+dcNo+")","function"),gridRowCount=callParentNew("GetDcRowCount("+dcNo+")","function"),gridFieldAlongwithCap=[];gridFieldNames.forEach(function(e,l){var t=parent.FNames.indexOf(e),r=parent.FCaption[t];gridFieldAlongwithCap.push(r+"("+e+")")});var check=gridFieldNames.some(function(e){return result[0].includes(e)}),checkwithCap=gridFieldAlongwithCap.some(function(e){return result[0].includes(e)});check||checkwithCap?0!=result[1].length?(xlresult=result,xlGridfieldNames=gridFieldNames,xlRowCount=gridRowCount,xlDcNo=dcNo):showAlertDialog("error",eval(callParent("lcm[511]"))):showAlertDialog("error",eval(callParent("lcm[510]")))}else showAlertDialog("error",eval(callParent("lcm[509]")))},FR.readAsArrayBuffer(file)}})});